<!DOCTYPE html>
<html lang="vi" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tạo Đề Thi Trắc Nghiệm</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.replit.com/agent/bootstrap-agent-dark-theme.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card shadow-sm">
                    <div class="card-header text-center bg-primary text-white">
                        <h1 class="mb-0">Tạo Đề Thi Trắc Nghiệm</h1>
                    </div>
                    <div class="card-body">
                        <div class="alert alert-info" role="alert">
                            <h5><i class="fas fa-info-circle me-2"></i>Hướng dẫn sử dụng:</h5>
                            <ol class="mb-0">
                                <li>Tải lên file Excel chứa câu hỏi trắc nghiệm với các cột sau:
                                    <ul>
                                        <li><strong>Câu hỏi</strong>: Nội dung câu hỏi</li>
                                        <li><strong>A</strong>: Nội dung đáp án A</li>
                                        <li><strong>B</strong>: Nội dung đáp án B</li>
                                        <li><strong>C</strong>: Nội dung đáp án C</li>
                                        <li><strong>D</strong>: Nội dung đáp án D</li>
                                        <li><strong>đáp án</strong>: Đáp án đúng (A, B, C, hoặc D)</li>
                                    </ul>
                                </li>
                                <li>Nhập số lượng câu hỏi và số phiên bản đề thi cần tạo</li>
                                <li>Tải về hai file ZIP chứa các đề thi đã được tạo ngẫu nhiên</li>
                            </ol>
                        </div>

                        <form id="uploadForm" enctype="multipart/form-data" class="needs-validation" novalidate>
                            <div class="mb-3">
                                <label for="excelFile" class="form-label">File Excel</label>
                                <input type="file" class="form-control" id="excelFile" name="excelFile" accept=".xlsx, .xls" required>
                                <div class="invalid-feedback">
                                    Vui lòng chọn một file Excel (.xlsx hoặc .xls)
                                </div>
                                <small class="text-muted">Chỉ hỗ trợ file Excel (.xlsx, .xls)</small>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="numQuestions" class="form-label">Số câu hỏi (n)</label>
                                    <input type="number" class="form-control" id="numQuestions" name="numQuestions" min="1" required>
                                    <div class="invalid-feedback">
                                        Vui lòng nhập số lớn hơn 0
                                    </div>
                                </div>
                                
                                <div class="col-md-6 mb-3">
                                    <label for="numVersions" class="form-label">Số phiên bản (m)</label>
                                    <input type="number" class="form-control" id="numVersions" name="numVersions" min="1" required>
                                    <div class="invalid-feedback">
                                        Vui lòng nhập số lớn hơn 0
                                    </div>
                                </div>
                            </div>
                            
                            <div class="d-grid">
                                <button type="submit" class="btn btn-primary" id="generateBtn">
                                    <i class="fas fa-cogs me-2"></i>Tạo Đề Thi
                                </button>
                            </div>
                        </form>
                        
                        <div id="alertArea" class="mt-3"></div>
                        
                        <div id="downloadArea" class="mt-3 d-none">
                            <div class="card bg-light">
                                <div class="card-body">
                                    <h5 class="card-title"><i class="fas fa-download me-2"></i>Tải Xuống File</h5>
                                    <div class="d-flex flex-column gap-2 mt-3">
                                        <a href="#" id="regularDownloadBtn" class="btn btn-outline-primary">
                                            <i class="fas fa-file-word me-2"></i>Tải Đề Thi Không Bôi Đáp Án
                                        </a>
                                        <a href="#" id="highlightedDownloadBtn" class="btn btn-outline-success">
                                            <i class="fas fa-highlighter me-2"></i>Tải Đề Thi Có Bôi Đáp Án Đúng
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card mt-4 shadow-sm">
                    <div class="card-header bg-secondary text-white">
                        <h5 class="mb-0"><i class="fas fa-question-circle me-2"></i>Câu Hỏi Thường Gặp</h5>
                    </div>
                    <div class="card-body">
                        <div class="accordion" id="faqAccordion">
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
                                        File Excel của tôi cần có định dạng như thế nào?
                                    </button>
                                </h2>
                                <div id="faq1" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                    <div class="accordion-body">
                                        File Excel của bạn cần có các cột sau: <code>Câu hỏi</code>, <code>A</code>, <code>B</code>, <code>C</code>, <code>D</code>, và <code>đáp án</code>. Cột "đáp án" chỉ được chứa các giá trị A, B, C, hoặc D.
                                        <p class="mt-2">Ứng dụng hỗ trợ file Excel có nhiều sheet. Tất cả các sheet đều phải có cùng định dạng với các cột tiêu chuẩn. Hệ thống sẽ tự động tổng hợp câu hỏi từ tất cả các sheet.</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
                                        Sự khác biệt giữa hai file ZIP là gì?
                                    </button>
                                </h2>
                                <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                    <div class="accordion-body">
                                        File ZIP đầu tiên chứa các tài liệu Word với câu hỏi được chọn ngẫu nhiên và tất cả các lựa chọn đáp án. File ZIP thứ hai chứa các tài liệu tương tự nhưng với đáp án đúng được bôi đậm.
                                    </div>
                                </div>
                            </div>
                            
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
                                        Câu hỏi được chọn ngẫu nhiên như thế nào?
                                    </button>
                                </h2>
                                <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                    <div class="accordion-body">
                                        Đối với mỗi phiên bản, hệ thống sẽ chọn ngẫu nhiên số lượng câu hỏi đã chỉ định từ file Excel của bạn. Mỗi phiên bản có thể có các câu hỏi khác nhau, cho phép bạn tạo nhiều bài kiểm tra độc đáo từ cùng một ngân hàng câu hỏi.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <footer class="mt-5 text-center text-muted">
            <p>&copy; 2023 Ứng Dụng Tạo Đề Thi Trắc Nghiệm. Đã đăng ký bản quyền.</p>
        </footer>
    </div>
    
    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="position-fixed top-0 start-0 w-100 h-100 d-none">
        <div class="d-flex justify-content-center align-items-center h-100 bg-dark bg-opacity-75">
            <div class="text-center text-white">
                <div class="spinner-border mb-3" role="status"></div>
                <h5>Đang tạo tài liệu...</h5>
                <p>Quá trình này có thể mất một chút thời gian tùy thuộc vào kích thước file.</p>
            </div>
        </div>
    </div>
    
    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>
