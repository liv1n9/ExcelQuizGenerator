<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Generator</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.replit.com/agent/bootstrap-agent-dark-theme.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card shadow-sm">
                    <div class="card-header text-center bg-primary text-white">
                        <h1 class="mb-0">Quiz Document Generator</h1>
                    </div>
                    <div class="card-body">
                        <div class="alert alert-info" role="alert">
                            <h5><i class="fas fa-info-circle me-2"></i>How it works:</h5>
                            <ol class="mb-0">
                                <li>Upload an Excel file containing quiz questions with the following columns:
                                    <ul>
                                        <li><strong>Câu hỏi</strong>: Question content</li>
                                        <li><strong>A</strong>: Option A content</li>
                                        <li><strong>B</strong>: Option B content</li>
                                        <li><strong>C</strong>: Option C content</li>
                                        <li><strong>D</strong>: Option D content</li>
                                        <li><strong>đáp án</strong>: Correct answer (A, B, C, or D)</li>
                                    </ul>
                                </li>
                                <li>Enter the number of questions and versions you want to generate</li>
                                <li>Download two ZIP files containing randomized quiz documents</li>
                            </ol>
                        </div>

                        <form id="uploadForm" enctype="multipart/form-data" class="needs-validation" novalidate>
                            <div class="mb-3">
                                <label for="excelFile" class="form-label">Excel File</label>
                                <input type="file" class="form-control" id="excelFile" name="excelFile" accept=".xlsx, .xls" required>
                                <div class="invalid-feedback">
                                    Please select an Excel file (.xlsx or .xls)
                                </div>
                                <small class="text-muted">Only Excel files (.xlsx, .xls) are supported</small>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="numQuestions" class="form-label">Number of Questions (n)</label>
                                    <input type="number" class="form-control" id="numQuestions" name="numQuestions" min="1" required>
                                    <div class="invalid-feedback">
                                        Please enter a valid number greater than 0
                                    </div>
                                </div>
                                
                                <div class="col-md-6 mb-3">
                                    <label for="numVersions" class="form-label">Number of Versions (m)</label>
                                    <input type="number" class="form-control" id="numVersions" name="numVersions" min="1" required>
                                    <div class="invalid-feedback">
                                        Please enter a valid number greater than 0
                                    </div>
                                </div>
                            </div>
                            
                            <div class="d-grid">
                                <button type="submit" class="btn btn-primary" id="generateBtn">
                                    <i class="fas fa-cogs me-2"></i>Generate Quiz Documents
                                </button>
                            </div>
                        </form>
                        
                        <div id="alertArea" class="mt-3"></div>
                        
                        <div id="downloadArea" class="mt-3 d-none">
                            <div class="card bg-light">
                                <div class="card-body">
                                    <h5 class="card-title"><i class="fas fa-download me-2"></i>Download Your Files</h5>
                                    <div class="d-flex flex-column gap-2 mt-3">
                                        <a href="#" id="regularDownloadBtn" class="btn btn-outline-primary">
                                            <i class="fas fa-file-word me-2"></i>Download Regular Quiz Documents
                                        </a>
                                        <a href="#" id="highlightedDownloadBtn" class="btn btn-outline-success">
                                            <i class="fas fa-highlighter me-2"></i>Download Quiz Documents with Answers Highlighted
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card mt-4 shadow-sm">
                    <div class="card-header bg-secondary text-white">
                        <h5 class="mb-0"><i class="fas fa-question-circle me-2"></i>Frequently Asked Questions</h5>
                    </div>
                    <div class="card-body">
                        <div class="accordion" id="faqAccordion">
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
                                        What format should my Excel file be in?
                                    </button>
                                </h2>
                                <div id="faq1" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                    <div class="accordion-body">
                                        Your Excel file should have the following columns: <code>Câu hỏi</code>, <code>A</code>, <code>B</code>, <code>C</code>, <code>D</code>, and <code>đáp án</code>. The "đáp án" column must contain only A, B, C, or D as values.
                                    </div>
                                </div>
                            </div>
                            
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
                                        What's the difference between the two ZIP files?
                                    </button>
                                </h2>
                                <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                    <div class="accordion-body">
                                        The first ZIP file contains Word documents with randomly selected questions and all answer options. The second ZIP file contains the same documents but with the correct answers highlighted in bold.
                                    </div>
                                </div>
                            </div>
                            
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
                                        How are questions randomly selected?
                                    </button>
                                </h2>
                                <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                    <div class="accordion-body">
                                        For each version, the system randomly selects the specified number of questions from your Excel file. Each version may have different questions, allowing you to create multiple unique quizzes from the same question bank.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <footer class="mt-5 text-center text-muted">
            <p>&copy; 2023 Quiz Document Generator. All rights reserved.</p>
        </footer>
    </div>
    
    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="position-fixed top-0 start-0 w-100 h-100 d-none">
        <div class="d-flex justify-content-center align-items-center h-100 bg-dark bg-opacity-75">
            <div class="text-center text-white">
                <div class="spinner-border mb-3" role="status"></div>
                <h5>Generating documents...</h5>
                <p>This may take a moment depending on the file size.</p>
            </div>
        </div>
    </div>
    
    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>
